<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/facelet-template.xhtml">

	<ui:define name="pageTitle">Find Flights</ui:define>
	<ui:define name="pageContent">

		<h:form id="form">
			<!-- 		RADIO BUTTON  -->
			<div id="oneWayFrame">
				<h:panelGrid columns="2">
					<p:selectOneRadio id="toggleReturn"
						value="#{searchFlightBean.oneWay}">
						<f:selectItem itemLabel="One way" itemValue="true" />
						<f:selectItem id="return" itemLabel="Return" itemValue="false" />
						<f:ajax render="returnDate" />
					</p:selectOneRadio>
				</h:panelGrid>
			</div>


			<!-- 		SELECTION  -->
			<h:panelGrid columns="4">
				<p:outputLabel for="departureLocation" value="From" />
				<p:inputText id="departureLocation"
					value="#{flightBean.fromLocation}">
					<p:watermark for="departureLocation" value="Departure"
						id="departureWm" />
				</p:inputText>

				<p:outputLabel for="arrivalLocation" value="To" />
				<p:inputText id="arrivalLocation" value="#{flightBean.toLocation}">
					<p:watermark for="arrivalLocation" value="Arrival" id="arrivalWm" />
				</p:inputText>

				<p:outputLabel for="departureDate" value="Departure" />
				<p:calendar id="departureDate"
					value="#{searchFlightBean.departureDate}"
					mindate="#{searchFlightBean.currentDate}" pages="2"
					placeholder="Enter date">
					<p:ajax event="dateSelect" update="returnDate" />
					<p:ajax event="change" update="returnDate" />
				</p:calendar>

				<p:outputLabel for="returnDate" value="Return" />
				<p:calendar id="returnDate" value="#{searchFlightBean.returnDate}"
					mindate="#{searchFlightBean.departureDate}" pages="2"
					disabled="#{searchFlightBean.oneWay}" effect="fold"
					placeholder="Enter date" />

				<p:outputLabel for="cabinClass" value="Cabin class" />
				<p:selectOneMenu id="cabinClass"
					value="#{searchFlightBean.cabinClass}" effect="fade">
					<f:selectItem itemLabel="economy" itemValue="Economy" />
					<f:selectItem itemLabel="business" itemValue="Business" />
					<f:selectItem itemLabel="first class" itemValue="FirstClass" />
				</p:selectOneMenu>

				<p:outputLabel for="preferredAirline" value="Preferred airline" />
				<p:selectOneMenu id="preferredAirline"
					value="#{searchFlightBean.cabinClass}" effect="fade">
					<f:selectItem itemLabel="Lufthansa" itemValue="1" />
					<f:selectItem itemLabel="Brussels Airlines" itemValue="2" />
					<f:selectItem itemLabel="ANA" itemValue="3" />
				</p:selectOneMenu>

			</h:panelGrid>

			<!-- 		SEARCH and RESET BUTTON  -->
			<div id="searchButtons">
				<p:commandButton styleClass="btn_style" id="submitButton"
					actionListener="#{flightBean.submitAction}" value="Find"
					update="outboundResults inboundResults">
					<f:ajax execute="@form" render="@form" />
				</p:commandButton>
				<p:commandButton styleClass="btn_style" id="resetButton"
					actionListener="#{flightBean.reset()}" value="reset">
					<f:ajax execute="@form" render="@form" />
				</p:commandButton>
			</div>

			<!-- 		SEARCH RESULTS  -->
			<h2>
				<p:outputLabel for="outboundResults" value="Departing flights"
					rendered="#{flightBean.rendered}" />
			</h2>
			<p:dataTable id="outboundResults" var="flight"
				value="#{flightBean.outboundFlights}" selectionMode="single"
				rowKey="#{flight.id}" sortBy="#{flight.price}"
				rendered="#{flightBean.rendered}">
				<p:ajax event="rowSelect" listener="#{selectionBean.onRowSelect}">
				</p:ajax>
				<p:column headerText="Date" sortBy="#{flight.id}">
					<h:outputText value="#{flight.departureTime.date}" />
				</p:column>
				<p:column headerText="From"
					sortBy="#{flight.departureLocation.country}">
					<h:outputText value="#{flight.departureLocation.country}" />
				</p:column>
				<p:column headerText="To" sortBy="#{flight.arrivalLocation.country}">
					<h:outputText value="#{flight.arrivalLocation.country}" />
				</p:column>
				<p:column headerText="Depart" sortBy="#{flight.departureTime.time}">
					<h:outputText value="#{flight.departureTime}" />
				</p:column>
				<p:column headerText="Arrive" sortBy="#{flight.arrivalTime}">
					<h:outputText value="#{flight.arrivalTime}" />
				</p:column>

				<p:column headerText="Seats" sortBy="Seats">
					<h:outputText
						value="#{searchFlightBean.cabinClass} == 'Economy' ? 'yes' : 'no'" />
				</p:column>

				<p:column headerText="Price" sortBy="#{flight.price}">
					<h:outputText value="#{flight.price}" />
				</p:column>
			</p:dataTable>

			<h2>
				<p:outputLabel for="inboundResults" value="Return flights"
					rendered="#{flightBean.rendered}" />
			</h2>
		<p><h:outputText value="You have selected a one way itinerary" rendered="#{flightBean.rendered and searchFlightBean.oneWay}"/></p>
			<p:dataTable id="inboundResults" var="flight"
				value="#{flightBean.inboundFlights}" selectionMode="single"
				rowKey="#{flight.id}" sortBy="#{flight.price}"
				rendered="#{flightBean.rendered and not searchFlightBean.oneWay}">
				<p:ajax event="rowSelect" listener="#{selectionBean.onRowSelect}">
				</p:ajax>
				<p:column headerText="Id" sortBy="#{flight.id}">
					<h:outputText value="#{flight.id}" />
				</p:column>
				<p:column headerText="From"
					sortBy="#{flight.departureLocation.country}">
					<h:outputText value="#{flight.departureLocation.country}" />
				</p:column>
				<p:column headerText="To" sortBy="#{flight.arrivalLocation.country}">
					<h:outputText value="#{flight.arrivalLocation.country}" />
				</p:column>
				<p:column headerText="Depart" sortBy="#{flight.departureTime}">
					<h:outputText value="#{flight.departureTime}" />
				</p:column>
				<p:column headerText="Arrive" sortBy="#{flight.arrivalTime}">
					<h:outputText value="#{flight.arrivalTime}" />
				</p:column>

				<p:column headerText="Seats" sortBy="Seats">
					<h:outputText
						value="#{searchFlightBean.cabinClass} == 'Economy' ? 'yes' : 'no'" />
				</p:column>

				<p:column headerText="Price" sortBy="#{flight.price}">
					<h:outputText value="#{flight.price}" />
				</p:column>
			</p:dataTable>
		</h:form>
	</ui:define>

</ui:composition>
</html>